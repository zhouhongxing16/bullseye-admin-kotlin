<?xml version="1.0" encoding="UTF-8"?>
<!--Created by  on Fri Dec 25 2020 19:52:09 GMT+0800 (中国标准时间)-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chris.bullseye.mapper.StaffMapper">
    <resultMap id="BaseResultMap" type="com.chris.bullseye.pojo.Staff">
        <id column="id" jdbcType="VARCHAR" property="id" />
        <result column="serial_no" jdbcType="VARCHAR" property="serialNo" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="gender_id" jdbcType="VARCHAR" property="genderId" />
        <result column="mobile" jdbcType="VARCHAR" property="mobile" />
        <result column="email" jdbcType="VARCHAR" property="email" />
        <result column="organization_id" jdbcType="VARCHAR" property="organizationId" />
        <result column="department_id" jdbcType="VARCHAR" property="departmentId" />
        <result column="major_id" jdbcType="VARCHAR" property="majorId" />
        <result column="birthday" jdbcType="VARCHAR" property="birthday" />
        <result column="academic_id" jdbcType="VARCHAR" property="academicId" />
        <result column="degree_id" jdbcType="VARCHAR" property="degreeId" />
        <result column="position_id" jdbcType="VARCHAR" property="positionId" />
        <result column="title_id" jdbcType="VARCHAR" property="titleId" />
        <result column="type_id" jdbcType="VARCHAR" property="typeId" />
        <result column="identify_type_id" jdbcType="VARCHAR" property="identifyTypeId" />
        <result column="identify_no" jdbcType="VARCHAR" property="identifyNo" />
        <result column="province_id" jdbcType="VARCHAR" property="provinceId" />
        <result column="city_id" jdbcType="VARCHAR" property="cityId" />
        <result column="policy" jdbcType="VARCHAR" property="policy" />
        <result column="nation_id" jdbcType="VARCHAR" property="nationId" />
        <result column="join_date" jdbcType="VARCHAR" property="joinDate" />
        <result column="remark" jdbcType="VARCHAR" property="remark" />
        <result column="user_id" jdbcType="VARCHAR" property="userId" />
        <result column="status" jdbcType="INTEGER" property="status" />
        <result column="created" jdbcType="TIMESTAMP" property="created" />
        <result column="img" jdbcType="VARCHAR" property="img" />

    </resultMap>

    <resultMap id="BaseResultMapDto" type="com.chris.bullseye.dto.StaffDto" extends="BaseResultMap">
        <result column="userName" jdbcType="VARCHAR" property="userName"/>
        <result column="majorName" jdbcType="VARCHAR" property="majorName"/>
    </resultMap>

    <resultMap id="StaffResultMapDto" type="com.chris.bullseye.entity.response.StaffResponse">
        <result column="majorName" jdbcType="VARCHAR" property="majorName"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="organizationName" jdbcType="VARCHAR" property="organizationName"/>
        <result column="titleName" jdbcType="VARCHAR" property="titleName"/>
        <result column="img" jdbcType="VARCHAR" property="img"/>
        <result column="id" jdbcType="VARCHAR" property="id"/>
    </resultMap>

    <sql id="basic_list">
        a.id, a.serial_no,a.img, a.name, a.gender_id, a.mobile, a.email, a.organization_id, a.department_id, a.major_id, a.birthday, a.academic_id, a.degree_id, a.position_id, a.title_id, a.type_id, a.identify_type_id, a.identify_no, a.province_id, a.city_id, a.policy, a.nation_id, a.join_date, a.remark, a.user_id, a.status, a.created
    </sql>

    <select id="getListByParams" resultMap="BaseResultMapDto" parameterType="map">
        SELECT
        <include refid="basic_list"/>,staff.name as userName,m.name as majorName
        FROM kb_staffs a
        left join kb_accounts act on act.id = a.user_id
        left join kb_staffs staff on staff.id = act.staff_id
        left join kb_majors m on m.id = a.major_id
        left join kb_organizations org on org.id = a.organization_id
        <where>
            <if test="id!=null and id!='' ">
                and a.id=#{ id }
            </if>
            <if test="serialNo!=null and serialNo!='' ">
                and a.serial_no LIKE CONCAT('%', #{ serialNo }, '%')
            </if>
            <if test="name!=null and name!='' ">
                and a.name LIKE CONCAT('%', #{ name }, '%')
            </if>
            <if test="genderId!=null and genderId!='' ">
                and a.gender_id=#{ genderId }
            </if>
            <if test="mobile!=null and mobile!='' ">
                and a.mobile LIKE CONCAT('%', #{ mobile }, '%')
            </if>
            <if test="email!=null and email!='' ">
                and a.email LIKE CONCAT('%', #{ email }, '%')
            </if>
            <if test="organizationId!=null and organizationId!='' ">
                and a.organization_id=#{ organizationId }
            </if>
            <if test="departmentId!=null and departmentId!='' ">
                and a.department_id=#{ departmentId }
            </if>
            <if test="majorId!=null and majorId!='' ">
                and a.major_id=#{ majorId }
            </if>
            <if test="birthday!=null and birthday!='' ">
                and a.birthday LIKE CONCAT('%', #{ birthday }, '%')
            </if>
            <if test="academicId!=null and academicId!='' ">
                and a.academic_id=#{ academicId }
            </if>
            <if test="degreeId!=null and degreeId!='' ">
                and a.degree_id=#{ degreeId }
            </if>
            <if test="positionId!=null and positionId!='' ">
                and a.position_id=#{ positionId }
            </if>
            <if test="titleId!=null and titleId!='' ">
                and a.title_id=#{ titleId }
            </if>
            <if test="typeId!=null and typeId!='' ">
                and a.type_id=#{ typeId }
            </if>
            <if test="identifyTypeId!=null and identifyTypeId!='' ">
                and a.identify_type_id=#{ identifyTypeId }
            </if>
            <if test="identifyNo!=null and identifyNo!='' ">
                and a.identify_no=#{ identifyNo }
            </if>
            <if test="provinceId!=null and provinceId!='' ">
                and a.province_id=#{ provinceId }
            </if>
            <if test="cityId!=null and cityId!='' ">
                and a.city_id=#{ cityId }
            </if>
            <if test="policy!=null and policy!='' ">
                and a.policy LIKE CONCAT('%', #{ policy }, '%')
            </if>
            <if test="nationId!=null and nationId!='' ">
                and a.nation_id=#{ nationId }
            </if>
            <if test="joinDate!=null and joinDate!='' ">
                and a.join_date LIKE CONCAT('%', #{ joinDate }, '%')
            </if>
            <if test="remark!=null and remark!='' ">
                and a.remark LIKE CONCAT('%', #{ remark }, '%')
            </if>
            <if test="userId!=null and userId!='' ">
                and a.user_id=#{ userId }
            </if>
            <if test="status!=null and status!='' ">
                and a.status = #{ status }
            </if>
            <if test="created!=null and created!='' ">
                and a.created LIKE CONCAT('%', #{ created }, '%')
            </if>
        </where>
        order by a.created desc
    </select>



    <select id="getSimpleDataByParams" resultMap="StaffResultMapDto" parameterType="map">
    SELECT
    <include refid="basic_list"/>,staff.name as userName,m.name as majorName,org.name as organizationName
    FROM kb_staffs a
    left join kb_accounts act on act.id = a.user_id
    left join kb_staffs staff on staff.id = act.staff_id
    left join kb_majors m on m.id = a.major_id
    left join kb_organizations org on org.id = a.organization_id
    <where>
        <if test="id!=null and id!='' ">
            and a.id=#{ id }
        </if>
        <if test="staffId!=null and staffId!='' ">
            and a.id=#{staffId}
        </if>
        </where>
    </select>

    <select id="getByParams" resultMap="BaseResultMapDto" parameterType="map">
        SELECT
        <include refid="basic_list"/>,staff.name as userName,m.name as majorName
        FROM kb_staffs a
        left join kb_accounts act on act.id = a.user_id
        left join kb_staffs staff on staff.id = act.staff_id
        left join kb_majors m on m.id = a.major_id
        left join kb_organizations org on org.id = a.organization_id
        <where>
            <if test="id!=null and id!='' ">
                and a.id=#{ id }
            </if>
            <if test="staffId!=null and staffId!='' ">
                and a.id=#{staffId}
            </if>
            <if test="serialNo!=null and serialNo!='' ">
                and a.serial_no =#{serialNo}
            </if>
            <if test="name!=null and name!='' ">
                and a.name LIKE CONCAT('%', #{ name }, '%')
            </if>
            <if test="genderId!=null and genderId!='' ">
                and a.gender_id=#{ genderId }
            </if>
            <if test="mobile!=null and mobile!='' ">
                and a.mobile LIKE CONCAT('%', #{ mobile }, '%')
            </if>
            <if test="email!=null and email!='' ">
                and a.email LIKE CONCAT('%', #{ email }, '%')
            </if>
            <if test="organizationId!=null and organizationId!='' ">
                and a.organization_id=#{ organizationId }
            </if>
            <if test="departmentId!=null and departmentId!='' ">
                and a.department_id=#{ departmentId }
            </if>
            <if test="majorId!=null and majorId!='' ">
                and a.major_id=#{ majorId }
            </if>
            <if test="birthday!=null and birthday!='' ">
                and a.birthday LIKE CONCAT('%', #{ birthday }, '%')
            </if>
            <if test="academicId!=null and academicId!='' ">
                and a.academic_id=#{ academicId }
            </if>
            <if test="degreeId!=null and degreeId!='' ">
                and a.degree_id=#{ degreeId }
            </if>
            <if test="positionId!=null and positionId!='' ">
                and a.position_id=#{ positionId }
            </if>
            <if test="titleId!=null and titleId!='' ">
                and a.title_id=#{ titleId }
            </if>
            <if test="typeId!=null and typeId!='' ">
                and a.type_id=#{ typeId }
            </if>
            <if test="identifyTypeId!=null and identifyTypeId!='' ">
                and a.identify_type_id=#{ identifyTypeId }
            </if>
            <if test="identifyNo!=null and identifyNo!='' ">
                and a.identify_no=#{ identifyNo }
            </if>
            <if test="provinceId!=null and provinceId!='' ">
                and a.province_id=#{ provinceId }
            </if>
            <if test="cityId!=null and cityId!='' ">
                and a.city_id=#{ cityId }
            </if>
            <if test="policy!=null and policy!='' ">
                and a.policy LIKE CONCAT('%', #{ policy }, '%')
            </if>
            <if test="nationId!=null and nationId!='' ">
                and a.nation_id=#{ nationId }
            </if>
            <if test="joinDate!=null and joinDate!='' ">
                and a.join_date LIKE CONCAT('%', #{ joinDate }, '%')
            </if>
            <if test="remark!=null and remark!='' ">
                and a.remark LIKE CONCAT('%', #{ remark }, '%')
            </if>
            <if test="userId!=null and userId!='' ">
                and a.user_id=#{ userId }
            </if>
            <if test="status!=null and status!='' ">
                and a.status = #{ status }
            </if>
            <if test="created!=null and created!='' ">
                and a.created LIKE CONCAT('%', #{ created }, '%')
            </if>
        </where>
        limit 1
    </select>
</mapper>